
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Test Coverage Audit - Agentic Index</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#test-coverage-audit" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Agentic Index" class="md-header__button md-logo" aria-label="Agentic Index" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Agentic Index
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Test Coverage Audit
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Agentic Index" class="md-nav__button md-logo" aria-label="Agentic Index" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Agentic Index
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../REFRESH/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Refresh Pipeline
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ci-audit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CI Audit Report
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CONFLICT_RESOLUTION/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conflict Resolution
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../coverage_baseline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Coverage Baseline
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DEVELOPMENT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Development Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../PERFORMANCE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Performance Tips
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../METRICS_ALERTS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metrics Alerts
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../methodology/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Methodology
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CLI Usage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/agentic_index_cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    agentic_index_cli
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/agentic_index_api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    agentic_index_api
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      1. Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-methodology" class="md-nav__link">
    <span class="md-ellipsis">
      2. Methodology
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-findings" class="md-nav__link">
    <span class="md-ellipsis">
      3. Findings
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Findings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-overall-coverage-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      3.1. Overall Coverage Metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-coverage-details" class="md-nav__link">
    <span class="md-ellipsis">
      3.2. Coverage Details
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-flaky-tests" class="md-nav__link">
    <span class="md-ellipsis">
      3.3. Flaky Tests
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-untested-modules-or-functionalities" class="md-nav__link">
    <span class="md-ellipsis">
      3.4. Untested Modules or Functionalities
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-recommendations" class="md-nav__link">
    <span class="md-ellipsis">
      4. Recommendations
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="test-coverage-audit">Test Coverage Audit</h1>
<h2 id="1-introduction">1. Introduction</h2>
<p>This document details the test coverage analysis for the Python codebase, primarily focusing on the <code>agentic_index_cli</code>, <code>api</code>, and <code>lib</code> modules. The audit aims to assess the extent of test coverage, identify areas with low coverage, and note any potential issues related to test stability or gaps in testing.</p>
<h2 id="2-methodology">2. Methodology</h2>
<p>Test coverage was measured using <code>pytest</code> with the <code>pytest-cov</code> plugin. The coverage report was generated in XML format and also as a terminal summary. The primary areas targeted for coverage analysis were <code>agentic_index_cli/</code>, <code>api/</code>, and <code>lib/</code>.</p>
<p>The CI pipeline (as defined in <code>.github/workflows/ci.yml</code>) enforces a coverage threshold, specified in <code>pyproject.toml</code>.</p>
<h2 id="3-findings">3. Findings</h2>
<h3 id="31-overall-coverage-metrics">3.1. Overall Coverage Metrics</h3>
<ul>
<li><strong>Overall Coverage</strong>: 81%</li>
<li><strong>Configured Minimum Threshold (<code>fail_under</code>)</strong>: 70</li>
<li><strong>Coverage Report (HTML)</strong>: An HTML version of the report (providing the most detail) is typically generated by running <code>coverage html</code>. For this audit, the key findings are summarized in this document based on the terminal output.</li>
</ul>
<h3 id="32-coverage-details">3.2. Coverage Details</h3>
<p>The terminal summary provides a per-module breakdown. Key observations (to be manually reviewed from the HTML report for more detail):</p>
<pre><code class="language-text">============================= test session starts ==============================
platform linux -- Python 3.10.17, pytest-8.3.5, pluggy-1.5.0
rootdir: /app
configfile: pytest.ini
plugins: socket-0.7.0, env-1.1.5, hypothesis-6.135.10, anyio-4.9.0, cov-6.1.1, json-report-1.5.0, metadata-3.1.1
collected 189 items

tests/test_agentic_index_network.py .......                              [  3%]
tests/test_agentic_index_utils.py ...                                    [  5%]
tests/test_agents_md.py .                                                [  5%]
tests/test_api_auth.py ....                                              [  7%]
tests/test_api_endpoints.py ..                                           [  8%]
tests/test_api_issue.py ...                                              [ 10%]
tests/test_api_main.py .                                                 [ 11%]
tests/test_api_score.py ...                                              [ 12%]
tests/test_api_server.py ..                                              [ 13%]
tests/test_api_sync.py .                                                 [ 14%]
tests/test_badge_cache.py s                                              [ 14%]
tests/test_badge_offline.py s                                            [ 15%]
tests/test_badges.py .                                                   [ 15%]
tests/test_by_category.py .                                              [ 16%]
tests/test_categorize_more.py .                                          [ 16%]
tests/test_category_cli_integration.py .                                 [ 17%]
tests/test_category_readme.py ..                                         [ 18%]
tests/test_category_section.py .                                         [ 19%]
tests/test_cli.py ..                                                     [ 20%]
tests/test_cli_exitcodes.py s                                            [ 20%]
tests/test_cli_help.py .                                                 [ 21%]
tests/test_cli_wrappers.py ....                                          [ 23%]
tests/test_codex_issue_logger.py .                                       [ 23%]
tests/test_codex_task_runner.py .                                        [ 24%]
tests/test_config.py ..                                                  [ 25%]
tests/test_coverage_gate.py ..                                           [ 26%]
tests/test_deltas.py .                                                   [ 26%]
tests/test_deltas_edge.py ...                                            [ 28%]
tests/test_enricher.py .                                                 [ 29%]
tests/test_extract.py .                                                  [ 29%]
tests/test_faststart.py .                                                [ 30%]
tests/test_fetch_badge.py sssssss                                        [ 33%]
tests/test_fmt_delta.py .....                                            [ 36%]
tests/test_helpers.py .                                                  [ 37%]
tests/test_inject_cli_script.py ...                                      [ 38%]
tests/test_inject_dry_run.py .....                                       [ 41%]
tests/test_inject_markers.py ..                                          [ 42%]
tests/test_inject_readme_cli.py .                                        [ 42%]
tests/test_inject_readme_unit.py .......                                 [ 46%]
tests/test_inject_row_count.py .                                         [ 47%]
tests/test_inject_script.py .                                            [ 47%]
tests/test_internal_issue_logger.py .                                    [ 48%]
tests/test_issue_logger.py ...........                                   [ 53%]
tests/test_link_integrity.py s                                           [ 54%]
tests/test_link_utils.py ...                                             [ 56%]
tests/test_main_cli.py .                                                 [ 56%]
tests/test_metric_plugins.py .                                           [ 57%]
tests/test_no_zero_metrics.py .                                          [ 57%]
tests/test_parse_table_abbr.py ...                                       [ 59%]
tests/test_pipeline_integration.py .                                     [ 59%]
tests/test_plot_trends.py ....                                           [ 61%]
tests/test_pr_issue_sync.py ...                                          [ 63%]
tests/test_prune.py .                                                    [ 64%]
tests/test_quality_metrics.py .......                                    [ 67%]
tests/test_quality_metrics_extra.py ......                               [ 70%]
tests/test_queue_sync.py .                                               [ 71%]
tests/test_quota.py .                                                    [ 71%]
tests/test_rank_cli.py .                                                 [ 72%]
tests/test_rank_positive.py .                                            [ 73%]
tests/test_ranking.py ...                                                [ 74%]
tests/test_readme_snapshot.py ..                                         [ 75%]
tests/test_refresh_category_integration.py .                             [ 76%]
tests/test_refresh_flags.py .                                            [ 76%]
tests/test_regression_allowlist.py .                                     [ 77%]
tests/test_regression_check.py ....                                      [ 79%]
tests/test_render_badge.py ..                                            [ 80%]
tests/test_render_endpoint.py .                                          [ 80%]
tests/test_repos_schema.py .                                             [ 81%]
tests/test_run_index.py .                                                [ 82%]
tests/test_score_formula.py .                                            [ 82%]
tests/test_score_fuzz.py .                                               [ 83%]
tests/test_score_nonzero.py .                                            [ 83%]
tests/test_scrape_errors.py ...                                          [ 85%]
tests/test_scrape_mock.py .                                              [ 85%]
tests/test_scrape_repos.py .                                             [ 86%]
tests/test_scrape_repos_cache.py ..                                      [ 87%]
tests/test_search_pagination.py .                                        [ 87%]
tests/test_snapshot_presence.py .                                        [ 88%]
tests/test_sorting.py ....                                               [ 90%]
tests/test_sync.py ..                                                    [ 91%]
tests/test_sync_queue_to_issues.py .                                     [ 92%]
tests/test_task_daemon.py .....                                          [ 94%]
tests/test_update_coverage_badge.py ss                                   [ 95%]
tests/test_update_diff.py ..                                             [ 96%]
tests/test_update_security_badge.py ss                                   [ 97%]
tests/test_validation_dup.py .                                           [ 98%]
tests/test_validation_extra.py .                                         [ 98%]
tests/test_validation_migrate.py .                                       [ 99%]
tests/test_validation_ok.py .                                            [100%]

=============================== warnings summary ===============================
tests/test_render_endpoint.py::test_render_endpoint
tests/test_render_endpoint.py::test_render_endpoint
  /app/api/app.py:60: PydanticDeprecatedSince20: The `dict` method is deprecated; use `model_dump` instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
    json_file.write_text(json.dumps([r.dict() for r in req.repos]))

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.10.17-final-0 _______________

Name                                             Stmts   Miss  Cover
--------------------------------------------------------------------
agentic_index_cli/__init__.py                        0      0   100%
agentic_index_cli/__main__.py                       40     12    70%
agentic_index_cli/agentic_index.py                 217     13    94%
agentic_index_cli/api_server.py                     31      4    87%
agentic_index_cli/config.py                         10      0   100%
agentic_index_cli/enricher.py                       66      4    94%
agentic_index_cli/exceptions.py                      4      0   100%
agentic_index_cli/faststart.py                      33      1    97%
agentic_index_cli/generate_outputs.py                9      1    89%
agentic_index_cli/helpers/__init__.py                4      0   100%
agentic_index_cli/helpers/click_options.py           5      0   100%
agentic_index_cli/helpers/markdown.py               12      3    75%
agentic_index_cli/inject.py                          9      1    89%
agentic_index_cli/inject_readme.py                  10      1    90%
agentic_index_cli/internal/__init__.py               0      0   100%
agentic_index_cli/internal/deltas.py                 8      0   100%
agentic_index_cli/internal/inject_readme.py        239     22    91%
agentic_index_cli/internal/issue_logger.py          16      2    88%
agentic_index_cli/internal/link_integrity.py        59     40    32%
agentic_index_cli/internal/rank.py                 150     18    88%
agentic_index_cli/internal/regression_check.py      78      8    90%
agentic_index_cli/internal/scrape.py                97     21    78%
agentic_index_cli/issue_logger.py                  273     61    78%
agentic_index_cli/plot_trends.py                     4      1    75%
agentic_index_cli/prune.py                          48     11    77%
agentic_index_cli/quality/__init__.py                0      0   100%
agentic_index_cli/quality/validate.py               43     43     0%
agentic_index_cli/rank.py                            5      0   100%
agentic_index_cli/ranker.py                         19      1    95%
agentic_index_cli/scraper.py                        12      1    92%
agentic_index_cli/task_daemon.py                   180     89    51%
agentic_index_cli/validate.py                      111      6    95%
api/__init__.py                                      0      0   100%
api/app.py                                          44      1    98%
api/sync.py                                         20      0   100%
lib/__init__.py                                      0      0   100%
lib/metrics_registry.py                             37      8    78%
lib/quality_metrics.py                              59      1    98%
--------------------------------------------------------------------
TOTAL                                             1952    374    81%
Coverage XML written to file /tmp/audit_outputs/test_coverage/coverage.xml
Required test coverage of 70.0% reached. Total coverage: 80.84%
============ 174 passed, 15 skipped, 2 warnings in 71.22s (0:01:11) ============
</code></pre>
<p>Low coverage areas (below the configured threshold or significantly lower than average) should be prioritized for adding more tests. The HTML report provides the most detailed view for identifying specific uncovered lines and branches.</p>
<h3 id="33-flaky-tests">3.3. Flaky Tests</h3>
<p>Identifying flaky tests typically requires analyzing historical test run data from the CI system over a period, which is beyond the scope of this automated audit subtask. Manual review of CI logs for frequently re-run or intermittently failing tests is recommended.</p>
<p>During this audit, no specific tools or configurations for automatic flaky test detection (e.g., <code>pytest-rerunfailures</code> with reporting) were observed in <code>pytest.ini</code> or CI configurations.</p>
<h3 id="34-untested-modules-or-functionalities">3.4. Untested Modules or Functionalities</h3>
<p>Based on the coverage report:
*   Modules or files showing 0% coverage or very low coverage are effectively untested.
*   A detailed review of the HTML coverage report is necessary to identify specific functions, classes, or code branches within modules that lack coverage.
*   <strong>Note</strong>: The coverage analysis was primarily scoped to <code>agentic_index_cli</code>, <code>api</code>, and <code>lib</code>. Other Python scripts or modules (e.g., in <code>scripts/</code>) might not be included in this coverage assessment unless explicitly added to the <code>pytest --cov</code> arguments. The existing CI configuration targets <code>agentic_index_cli</code>. This audit expanded it to <code>api</code> and <code>lib</code>.</p>
<h2 id="4-recommendations">4. Recommendations</h2>
<ol>
<li><strong>Review Detailed HTML Report</strong>: The primary action is to thoroughly review the generated HTML coverage report (<code>htmlcov/index.html</code>) to pinpoint specific lines, branches, and functions that are not covered.</li>
<li><strong>Increase Coverage in Low-Coverage Areas</strong>: Prioritize writing new tests for modules and functionalities that are critical and have low coverage. Aim to meet or exceed the configured <code>70</code> threshold consistently across all important modules.</li>
<li><strong>Test Critical Edge Cases</strong>: Ensure tests cover not just "happy path" scenarios but also edge cases, error conditions, and invalid inputs.</li>
<li><strong>Flaky Test Management</strong>:<ul>
<li>Consider implementing tools like <code>pytest-rerunfailures</code> to manage and identify flaky tests more systematically.</li>
<li>Establish a process for investigating and fixing flaky tests promptly when they are detected in CI.</li>
</ul>
</li>
<li><strong>Expand Coverage Scope (If Necessary)</strong>: Evaluate if other Python directories/modules (e.g., utility scripts in <code>scripts/</code>) are critical enough to warrant inclusion in the regular coverage runs. If so, update the <code>--cov</code> arguments in the CI configuration.</li>
<li><strong>Maintain Coverage Threshold</strong>: Keep the <code>fail_under</code> threshold in <code>pyproject.toml</code> relevant and consider gradually increasing it as test coverage improves.</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.50899def.min.js"></script>
      
    
  </body>
</html>